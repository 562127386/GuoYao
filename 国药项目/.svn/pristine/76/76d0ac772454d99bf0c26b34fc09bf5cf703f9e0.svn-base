@*------------------------------------------------------------------------------
    *     此代码由T4模板自动生成
    *	   生成时间 2018-12-06 18:24:38
    *     ©为之团队
    *------------------------------------------------------------------------------*@

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Index.cshtml";
}
<script>


    $(function () {
        
        gridList();
        initControl();
    });

    //
    function gridList() {
       
        var $gridList = $("#gridList");
        $gridList.dataGrid({
            url: "/GY/GY_SCDY/GetGridSee",
            height: $(window).height() - 168,
            //postData: { queryJson: JSON.stringify(queryJson) },
            colModel: [

					{ label: "主键", name: "Id", width: 150, align: 'left', hidden: true },

					{ label: "状态", name: "status", width: 150, align: 'left' },

					{ label: "医院", name: "hname", width: 150, align: 'left' },

					{ label: "病症", name: "symptoms", width: 150, align: 'left' },

					{ label: "患者姓名", name: "pname", width: 150, align: 'left' },

					{ label: "患者性别", name: "psex", width: 150, align: 'left' },

					{ label: "患者年龄", name: "page", width: 150, align: 'left' },

					{ label: "体重", name: "pweight", width: 150, align: 'left' },

					{ label: "病史", name: "mhistory", width: 150, align: 'left' },

					{ label: "治疗时间", name: "opertime", width: 150, align: 'left' },

					{ label: "联系方式", name: "linktype", width: 150, align: 'left' },

					{ label: "家属电话", name: "phone", width: 150, align: 'left' },

					{ label: "主治医生", name: "chiefdoctor", width: 150, align: 'left' },

					{
					    label: "是否住院", name: "isinhospital", width: 150, align: 'left', formatter: function (cellvalue, options, rowObject) {
					        if (cellvalue == "1") {
					            return '是';
					        } else {
					            return '否';
					        }
					    }
					},

					{ label: "住院号", name: "hospitalnum", width: 150, align: 'left' },

					{ label: "床位号", name: "bednum", width: 150, align: 'left' },

					{ label: "照片", name: "photo", width: 150, align: 'left' },

					{ label: "服务商", name: "CreateUserName", width: 150, align: 'left' },

					{ label: "支持厂家", name: "bfactoryname", width: 150, align: 'left' },

					{ label: "提报人", name: "reportman", width: 150, align: 'left', hidden: true },

					{ label: "提报时间", name: "reportdate", width: 150, align: 'left', hidden: true },

					{ label: "审核人", name: "audit", width: 150, align: 'left', hidden: true },

					{ label: "审核时间", name: "audittime", width: 150, align: 'left', hidden: true },

					{ label: "审核意见", name: "auditlog", width: 150, align: 'left', hidden: true },

					{ label: "支持厂家编号", name: "bfactorycode", width: 150, align: 'left', hidden: true },

					{ label: "创建日期", name: "CreateDate", width: 150, align: 'left', hidden: true },

					{ label: "创建用户账户", name: "CreateUserId", width: 150, align: 'left', hidden: true },

					{ label: "最后修改时间", name: "UpdateDate", width: 150, align: 'left', hidden: true },

					{ label: "最后修改用户", name: "UpdateUserId", width: 150, align: 'left', hidden: true },

					{ label: "最后修改用户名称", name: "UpdateUserName", width: 150, align: 'left', hidden: true },

					{ label: "扩展字段4", name: "extend4", width: 150, align: 'left', hidden: true },

					{ label: "扩展字段5", name: "extend5", width: 150, align: 'left', hidden: true },

            ],
            pager: "#gridPager",
            sortname: 'CreateDate desc',
            viewrecords: true
        });
        $("#btn_search").click(function () {
            var queryJson = {
                startDate: $("#startDate").val(),
                endDate: $("#endDate").val(),
                searchYY: $("#searchYY").val(),
                searchCJ: $("#searchCJ").val(),
                searchQX: $("#searchQX").val()
            }
            $gridList.jqGrid('setGridParam', {
                postData: { queryJson: JSON.stringify(queryJson) }, page: 1
            }).trigger('reloadGrid');
        });
    }
    function initControl() {

        $("#searchYY").bindSelect({
            id: "text",
            url: "/GY/GY_YY/GetTreeSelectJson",
            placeholder: "请选择医院",
            search:true
        });
        $("#searchCJ").bindSelect({
            id: "text",
            url: "/GY/GY_CJ/GetTreeSelectJson",
            placeholder: "请选择厂家",
            search: true
        });
    }
    function btn_details() {
        /*var keyValue = $("#gridList").jqGridRowValue().Id;      
		if ($.checkedArray(keyValue))
		 {
			$.modalOpen({
				id: "Details",
				title: "查看厂家基本信息",
				url: "/GY/GY_CJ/Details?keyValue=" + keyValue,
				width: "550px",
				height: "620px",
				btn: null,
			});
		  }*/
        var parentId = top.$.jfinetab.getCurrentTabId();
        var Id = $("#gridList").jqGridRowValue().Id;
        if ($.checkedArray(Id)) {
            top.$.jfinetab.addTabContent("/GY/GY_SCDY/Details?keyValue=" + Id, "市场调研--查看", parentId + "_view", parentId);
        }
    }

</script>
<div class="topPanel">
   
    <div class="search">
        <table>
            <tr>
                <td style="padding-left:10px;">提报日期:</td>
                <td style="padding-left:5px;">
                    <div class="input-group">
                        <input id="startDate" type="text" class="form-control Wdate"
                               onfocus="WdatePicker({lang:'zh-cn',dateFmt:'yyyy-MM-dd'})" placeholder="提报日期" style="width:100px">
                    </div>
                </td>
                <td style ="padding-left:5px;">--</td>
                <td style="padding-left:5px;">
                    <div class="input-group">
                        <input id="endDate" type="text" class="form-control Wdate"
                               onfocus="WdatePicker({lang:'zh-cn',dateFmt:'yyyy-MM-dd'})" placeholder="提报日期" style="width:100px" />
                    </div>
                </td>
                <td style="padding-left:20px;">医院名称:</td>
                <td style="padding-left:5px;">
                    <div class="input-group">
                        <select id="searchYY" name="searchYY">
                            <option></option>
                        </select>
                    </div>
                </td>
                <td style="padding-left:20px;">厂家名称:</td>
                <td style="padding-left:5px;">
                    <div class="input-group">
                        <select id="searchCJ" name="serchCJ">
                            <option></option>
                        </select>
                    </div>
                </td>
                <td style="padding-left:20px;">器械名称:</td>                 
                <td style="padding-left:5px;">
                    <div class="input-group">
                        <input id="searchQX" name="serchQX" class="form-control" style="width: 200px;" placeholder="请输入器械名称" />
                        <span class="input-group-btn">
                            <button id="btn_search" type="button" class="btn  btn-primary"><i class="fa fa-search"></i></button>
                        </span>
                    </div>
                </td>
                <td style ="padding-left:20px;"><a id="JF-Details" class="btn btn-primary dropdown-text" onclick="btn_details()"><i class="fa fa-search-plus"></i>查看</a></td>
            </tr>
        </table>
    </div>
</div>
<div class="gridPanel">
    <table id="gridList"></table>
    <div id="gridPager"></div>
</div>
